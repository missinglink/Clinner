<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>

  <title>ncuesta/Clinner @ GitHub</title>

  <link rel="stylesheet" type="text/css" href="css/github.css">
  <style type="text/css">
    body {
      margin-top: 1.0em;
      background-color: #fff;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 700px;
    }
    h1 { font-size: 3.8em; color: #a54e09; margin-bottom: 3px; }
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #a54e09; }
    h3 { text-align: center; color: #a54e09; }
    a { color: #a54e09; text-decoration: none; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { border: 1px solid #ccc; background: #eee; color: #333; padding: 15px; border-radius: 4px; box-shadow: 0 2px 2px rgba(0, 0, 0, .5);}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    code { border: 1px solid #ccc; background: #eee; padding: 0 2px; border-radius: 3px; color: #333;}
    footer { text-align:center; padding-top:30px; font-style: italic; }
  </style>
</head>

<body>
  <a href="https://github.com/ncuesta/Clinner"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>

  <div id="container">

    <div class="download">
      <a href="https://github.com/ncuesta/Clinner/zipball/master">
        <img border="0" width="90" src="https://github.com/images/modules/download/zip.png"></a>
      <a href="https://github.com/ncuesta/Clinner/tarball/master">
        <img border="0" width="90" src="https://github.com/images/modules/download/tar.png"></a>
    </div>



    <h1><a href="https://github.com/ncuesta/Clinner">Clinner</a>
      <span class="small">by <a href="https://github.com/ncuesta">ncuesta</a></span></h1>

    <p><a href="http://travis-ci.org/ncuesta/Clinner"><img src="https://secure.travis-ci.org/ncuesta/Clinner.png" alt="Build Status"></a></p>

    <div class="description">
      <code>Clinner</code> is a PHP 5.3+ Command-Line Interface commands execution abstraction.
    </div>

    
      <p>Clinner is a PHP library that turns command-line programs into PHP objects that can easily be combined with PHP functions to create simple chains of commands and/or plain PHP code.</p>

      <h2>Advantages</h2>

      <p><code>Clinner</code> has the following benefits:</p>

      <ul>
      <li>Minimalistic.</li>
      <li>Simple and easy to use.</li>
      <li><code>Clinner</code> uses <a href="http://getcomposer.org">Composer</a>. You can use it as a dependency and have it autoloaded in your code.</li>
      <li>Fluent API.</li>
      <li>Higher-level and object oriented interface to commands.</li>
      <li>Command pipes, <strong>regardless of the underlying OS</strong>.</li>
      <li>Commands might be actual command-line executables or PHP code.</li>
      <li><em>Yes, you can mix commands and PHP code in an OO way!</em></li>
      <li>Easily extendable through Interface implementation.</li>
      <li>MIT Licensed.</li>
      </ul>
      
      <h2>Usage</h2>

      <h3>Simple usage</h3>

      <p>The most basic use of <code>Clinner</code> consists of including <a href="https://github.com/ncuesta/Clinner/blob/master/clinner.phar?raw=true">the PHAR file</a>
      and using its <code>Command</code> class:</p>

      <div class="highlight">
<pre><span class="cp">&lt;?php</span>

<span class="c1">// List current working directory's files and store the list as a string</span>
<span class="k">require_once</span> <span class="s1">'phar://clinner.phar/autoload.php'</span><span class="p">;</span>

<span class="nv">$command</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Clinner\Command\Command</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">);</span>
<span class="nv">$files</span> <span class="o">=</span> <span class="nv">$command</span>
    <span class="o">-&gt;</span><span class="na">run</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">getOutput</span><span class="p">();</span>
<span class="c1">// Or get them as an array</span>
<span class="nv">$filesArray</span> <span class="o">=</span> <span class="nv">$command</span><span class="o">-&gt;</span><span class="na">getOutputAsArray</span><span class="p">();</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$command</span><span class="o">-&gt;</span><span class="na">getExitCode</span><span class="p">()</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Everything went fine.'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Something didn\'t work as expected...'</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// There's also a factory method that allows to make best use of the fluent API</span>
<span class="k">echo</span> <span class="nx">\Clinner\Command\Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">run</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">getOutput</span><span class="p">();</span>
</pre>
      </div>


      <h3>Passing arguments</h3>

      <p>Commands crave for arguments, so <code>Clinner</code> offers a way to satisfying them.
      By passing in a second argument to the factory method or the constructor, or using the dedicated setter
      method <code>setArguments()</code>.</p>

      <div class="highlight">
<pre><span class="cp">&lt;?php</span>

<span class="c1">// Commands will most certainly take arguments, so let's try something with them</span>
<span class="nv">$command</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Clinner\Command\Command</span><span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'/etc/hosts'</span><span class="p">));</span>
<span class="c1">// This will run `cat /etc/hosts`</span>
<span class="nv">$command</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>

<span class="c1">// You can use its factory method to take even more advantage of the fluent API</span>
<span class="k">echo</span> <span class="nx">\Clinner\Command\Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'/etc/hosts'</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">run</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">getOutput</span><span class="p">();</span>
</pre>
      </div>


      <p>Arguments can either be key-value pairs or just values. Key value pairs will be joined using a
      <code>delimiter</code> (see <strong>Options</strong> section for more information).</p>

      <h3>Options</h3>

      <p>Options allow customization of different <code>Command</code> behaviors. They can be passed in as a third
      argument for the factory method or constructor, or set via the <code>setOptions()</code> method.</p>

      <p>Currently there's only one thing that can be customized for the <code>Command</code> class, but it's worth
      noting it: you might specify the delimiter, a <code>string</code> that will be used to join key-value pairs
      of arguments. If not specified, it will default to the equals sign (<code>=</code>).</p>

      <p>Let's see an example:</p>

      <div class="highlight">
<pre><span class="cp">&lt;?php</span>

<span class="c1">// `cut` command won't work if key-value pairs of arguments are joined with '=':</span>
<span class="nv">$command</span> <span class="o">=</span> <span class="nx">\Clinner\Command\Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span>
    <span class="s1">'cut'</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'-d'</span> <span class="o">=&gt;</span> <span class="s1">':'</span><span class="p">,</span>
        <span class="s1">'-f'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">'/etc/passwd'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">);</span>

<span class="nv">$command</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span> <span class="c1">// =&gt; will run `cut -d=: -f=1 /etc/passwd` (WRONG)</span>

<span class="nv">$command</span><span class="o">-&gt;</span><span class="na">setOptions</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'delimiter'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">));</span>

<span class="nv">$command</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span> <span class="c1">// =&gt; will run `cut -d: -f1 /etc/passwd` (CORRECT)</span>
</pre>
      </div>

      <h3>Advanced usage: Commands pipes</h3>

      <p>Commands can be piped just like in any Unix shell. The basics of command pipes is that the output
      of a command is sent to the one that is piped to it.</p>

      <p>For example, if you want to run <code>ls -a | grep -i clinner</code>, you can:</p>

      <div class="highlight">
<pre><span class="cp">&lt;?php</span>

<span class="nv">$grepCommand</span> <span class="o">=</span> <span class="nx">\Clinner\Command\Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'grep'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'-i'</span><span class="p">,</span> <span class="s1">'clinner'</span><span class="p">));</span>
<span class="nv">$lsCommand</span>   <span class="o">=</span> <span class="nx">\Clinner\Command\Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'-a'</span><span class="p">));</span>

<span class="nv">$lsCommand</span>
    <span class="o">-&gt;</span><span class="na">pipe</span><span class="p">(</span><span class="nv">$grepCommand</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>

<span class="nv">$pipeOutput</span> <span class="o">=</span> <span class="nv">$lsCommand</span><span class="o">-&gt;</span><span class="na">getOutput</span><span class="p">();</span>

<span class="c1">// Or the same thing in an uglier but more pro way</span>
<span class="k">use</span> <span class="nx">\Clinner\Command\Command</span><span class="p">;</span>

<span class="nv">$pipeOutput</span> <span class="o">=</span> <span class="nx">Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'-a'</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">pipe</span><span class="p">(</span><span class="nx">Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'grep'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'-i'</span><span class="p">,</span> <span class="s1">'clinner'</span><span class="p">)))</span>
    <span class="o">-&gt;</span><span class="na">run</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">getOutput</span><span class="p">();</span>
</pre>
      </div>

      <p>Command pipes are not limited to a number of commands, you only need <em>at least</em> two commands.</p>

      <p>See next section for a more complex example involving 3 commands in a pipeline.</p>

      <h3>Advanced usage: Mixing PHP with commands</h3>

      <p>Apart from <code>Command</code> class, <code>Clinner</code> ships with a <code>Callback</code> command class that enables to
      mix both commands and PHP code in a command pipe. <em>Pretty cool, huh?</em></p>

      <p><code>Callback</code> class only takes a <code>Closure</code> or a function reference in its constructor and then
      is ready to run. That <code>Closure</code> function will receive the command's input as its first argument
      and is expected to return an exit code. Any information output by the function (either via <code>echo</code>
      or <code>print</code> or any other output method) will be considered as the command output and will be sent
      to the next command in the pipe, if any.</p>

      <div class="highlight">
<pre><span class="cp">&lt;?php</span>

<span class="c1">// Get all the usernames in the system that contain an 'a' in them</span>
<span class="nv">$callbackCommand</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Callback</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="nv">$input</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="nb">strchr</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"</span><span class="si">$line</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nv">$systemUsers</span> <span class="o">=</span> <span class="nx">Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">pipe</span><span class="p">(</span>
        <span class="nx">Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'grep'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'-v'</span> <span class="o">=&gt;</span> <span class="s1">'^#'</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">'delimiter'</span> <span class="o">=&gt;</span> <span class="s1">' '</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">pipe</span><span class="p">(</span>
        <span class="nx">Command</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'cut'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'-d'</span> <span class="o">=&gt;</span> <span class="s1">':'</span><span class="p">,</span> <span class="s1">'-f'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">'delimiter'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">pipe</span><span class="p">(</span><span class="nv">$callbackCommand</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">run</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">getOutputAsArray</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
</pre>
      </div>

      <h2>Dependencies</h2>
      <p>PHP 5.3.2 or greater.
If run from source, you'll need Composer. Otherwise, it has no other dependencies.</p>
    

    
      <h2>Install</h2>
      <p>Download the phar file, drop it on your application, include it and love it!</p>
    

    
      <h2>License</h2>
      <p>This code is provided under the MIT license</p>
    

      <h2>Contributing</h2>

      <p>Please, feel free to fork this repo and improve it in any way you consider useful
       -- Pull Requests are welcome!</p>    
    
      <h2>Authors</h2>
      <p>José Nahuel Cuesta Luengo (nahuelcuestaluengo at gmail.com)
<br/>      </p>
    

    
      <h2>Contact</h2>
      <p>José Nahuel Cuesta Luengo (nahuelcuestaluengo at gmail.com)
<br/>      </p>
    

    <h2>Download</h2>
    <p>
      You can download this project in either
      <a href="https://github.com/ncuesta/Clinner/zipball/master">zip</a> or
      <a href="https://github.com/ncuesta/Clinner/tarball/master">tar formats.
    </p>
    <p>You can also clone the project with <a href="http://git-scm.com">Git</a>
      by running:
      <pre>$ git clone git://github.com/ncuesta/Clinner</pre>
    </p>

    <footer>
      Get the source code on GitHub: <a href="https://github.com/ncuesta/Clinner">ncuesta/Clinner</a>
    </footer>

  </div>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28341570-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
